<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- should also validate ok with DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/xhtml1-transitional.dtd" -->
<html><head>
	<title>FreePBX Administration</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<link href="admin_data/mstyle_autogen_1360092071.css" rel="stylesheet" type="text/css">
	<style type="text/css">
		body {
		background-image: url(images/shadow-side-background.png?load_version=2.9.0.12);
		background-repeat: repeat-y;
		background-position: left;
		}
	</style>
	<link rel="shortcut icon" href="http://10.20.30.42/admin/images/favicon.ico">
	<link href="admin_data/config.css" rel="stylesheet" type="text/css">

  <script type="text/javascript" src="admin_data/script.js"></script>
  <script type="text/javascript" src="admin_data/libfreepbx.js" language="javascript"></script>
	
<!--[if IE]>
    <style type="text/css">div.inyourface a{position:absolute;}</style>
<![endif]-->
</head>

<body onload="body_loaded();">

<!-- module process box, used by module admin (page.modules.php) - has to be here because of IE6's z-order stupidity -->
<div id="moduleBox" style="display:none;"></div>

<div id="page">
	<div id="header">
		<div id="freepbx"><a href="http://www.freepbx.org/" target="_blank" title="FreePBX"><img src="admin_data/freepbx_large.png" alt="FreePBX"></a></div>
		<div id="version"><a href="http://www.freepbx.org/" target="_blank">FreePBX</a> 2.9.0.12 on <a href="http://10.20.30.42/">10.20.30.42</a></div>
		<ul id="metanav">
		<li class="first-current"><a href="http://10.20.30.42/admin/config.php">Admin</a></li>
		<li class="noselect"><a href="http://10.20.30.42/admin/reports.php">Reports</a></li>
		<li class="noselect"><a href="http://10.20.30.42/admin/panel.php">Panel</a></li>
		<li class="noselect"><a target="ari" href="http://10.20.30.42/recordings/index.php">Recordings</a></li>
		<li class="noselect"><a target="help" href="http://www.freepbx.org/freepbx-help-system?freepbx_version=2.9.0.12&amp;freepbx_menuitem=routing">Help</a></li>
<li class="last"><a>&nbsp;</a></li>		</ul>
		<div id="logo"><a href="http://www.freepbx.org/" target="_blank" title="FreePBX"><img src="admin_data/custom-logo.gif" alt="FreePBX"></a></div>
	<div id="login_message">	</div>	</div>

<div id="content">

<!-- begin menu -->
<div class="ui-tabs ui-widget ui-widget-content ui-corner-all" id="nav">
	<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" id="nav-tabs">
		<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#nav-setup"><span>Setup</span></a></li>
		<li class="ui-state-default ui-corner-top"><a href="#nav-tool"><span>Tools</span></a></li>
		<li class="last"><a><span>&nbsp;</span></a></li>
	</ul>
	<div class="ui-tabs-panel ui-widget-content ui-corner-bottom" id="nav-setup"><ul>
		<li title="click to expand/collapse section" id="setup-e3afed0047b08059d0fada10f400c1e5" class="category category-header toggle-minus">Admin</li>
			<li class="menuitem id-setup-e3afed0047b08059d0fada10f400c1e5"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=index">FreePBX System Status</a></li>
			<li class="menuitem id-setup-e3afed0047b08059d0fada10f400c1e5"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=modules">Module Admin</a></li>
		<li title="click to expand/collapse section" id="setup-972e73b7a882d0802a4e3a16946a2f94" class="category category-header toggle-minus">Basic</li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=dahdi">DAHDi</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=extensions">Extensions</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=featurecodeadmin">Feature Codes</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=general">General Settings</a></li>
			<li class="menuitem current id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=routing">Outbound Routes</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=trunks">Trunks</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=voicemail">Voicemail Admin</a></li>
			<li class="menuitem id-setup-972e73b7a882d0802a4e3a16946a2f94"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=ampusers">Administrators</a></li>
		<li title="click to expand/collapse section" id="setup-7eec029e6d0d83dcd40bc218cbc04e85" class="category category-header toggle-minus">Inbound Call Control</li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=did">Inbound Routes</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=zapchandids">Zap Channel DIDs</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=announcement">Announcements</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=blacklist">Blacklist</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=superfecta">CID Superfecta</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=daynight">Call Flow Control</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=cidlookup">CallerID Lookup Sources</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=findmefollow">Follow Me</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=ivr">IVR</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=queueprio">Queue Priorities</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=queues">Queues</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=ringgroups">Ring Groups</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=timeconditions">Time Conditions</a></li>
			<li class="menuitem id-setup-7eec029e6d0d83dcd40bc218cbc04e85"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=timegroups">Time Groups</a></li>
		<li title="click to expand/collapse section" id="setup-fcc42e3dc88422b722c17e20c26a39a1" class="category category-header toggle-minus">Internal Options &amp; Configuration</li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=callback">Callback</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=conferences">Conferences</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=disa">DISA</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=languages">Languages</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=miscapps">Misc Applications</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=miscdests">Misc Destinations</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=music">Music on Hold</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=pinsets">PIN Sets</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=paging">Paging and Intercom</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=parking">Parking Lot</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=restart">Phone Restart</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=recordings">System Recordings</a></li>
			<li class="menuitem id-setup-fcc42e3dc88422b722c17e20c26a39a1"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=vmblast">Voicemail Blasting</a></li>
		<li title="click to expand/collapse section" id="setup-b988b61dd9ca7cbbea7d68b6b24d749f" class="category category-header toggle-minus">Third Party Addon</li>
			<li class="menuitem id-setup-b988b61dd9ca7cbbea7d68b6b24d749f"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=customcontexts">Custom Contexts</a></li>
			<li class="menuitem id-setup-b988b61dd9ca7cbbea7d68b6b24d749f"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=googlevoice">Google Voice</a></li>
			<li class="menuitem id-setup-b988b61dd9ca7cbbea7d68b6b24d749f"><a href="http://10.20.30.42/admin/config.php?type=setup&amp;display=setcid">Set CallerID</a></li>
	</ul></div>
	<div class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide" id="nav-tool"><ul>
		<li title="click to expand/collapse section" id="tool-e3afed0047b08059d0fada10f400c1e5" class="category category-header toggle-minus">Admin</li>
			<li class="menuitem id-tool-e3afed0047b08059d0fada10f400c1e5"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=index">FreePBX System Status</a></li>
			<li class="menuitem id-tool-e3afed0047b08059d0fada10f400c1e5"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=modules">Module Admin</a></li>
		<li title="click to expand/collapse section" id="tool-1c658793ae21708c581ed334ab1e2499" class="category category-header toggle-minus">Advanced Administration</li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=advancedsettings">Advanced Settings</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=iaxsettings">Asterisk IAX Settings</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=sipsettings">Asterisk SIP Settings</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=bulkdids">Bulk DIDs</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=bulkextensions">Bulk Extensions</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=customdests">Custom Destinations</a></li>
			<li class="menuitem id-tool-1c658793ae21708c581ed334ab1e2499"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=customextens">Custom Extensions</a></li>
		<li title="click to expand/collapse section" id="tool-e56ae9acc1de553b5a7d70113790e3b9" class="category category-header toggle-minus">End Point Manager</li>
			<li class="menuitem id-tool-e56ae9acc1de553b5a7d70113790e3b9"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=epm_devices">End Point Device List</a></li>
			<li class="menuitem id-tool-e56ae9acc1de553b5a7d70113790e3b9"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=epm_templates">End Point Template Manager</a></li>
			<li class="menuitem id-tool-e56ae9acc1de553b5a7d70113790e3b9"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=epm_config">End Point Configuration</a></li>
			<li class="menuitem id-tool-e56ae9acc1de553b5a7d70113790e3b9"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=epm_advanced">End Point Advanced Settings</a></li>
		<li title="click to expand/collapse section" id="tool-10d0de28911c5f66463b9c8783f8148a" class="category category-header toggle-minus">Maintenance</li>
			<li class="menuitem id-tool-10d0de28911c5f66463b9c8783f8148a"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=configedit">Config Edit</a></li>
			<li class="menuitem id-tool-10d0de28911c5f66463b9c8783f8148a"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=sysinfo">Sys Info</a></li>
			<li class="menuitem id-tool-10d0de28911c5f66463b9c8783f8148a"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=phpmyadmin">phpMyAdmin</a></li>
		<li title="click to expand/collapse section" id="tool-db5eb84117d06047c97c9a0191b5fffe" class="category category-header toggle-minus">Support</li>
			<li class="menuitem id-tool-db5eb84117d06047c97c9a0191b5fffe"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=logfiles">Asterisk Logfiles</a></li>
			<li class="menuitem id-tool-db5eb84117d06047c97c9a0191b5fffe"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=irc">Online Support</a></li>
			<li class="menuitem id-tool-db5eb84117d06047c97c9a0191b5fffe"><a href="http://freepbx.org/" target="_blank">FreePBX Support</a></li>
		<li title="click to expand/collapse section" id="tool-afde5a73d112b230adb0e3b203265409" class="category category-header toggle-minus">System Administration</li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=manager">Asterisk API</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=cli">Asterisk CLI</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=asteriskinfo">Asterisk Info</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=phonebook">Asterisk Phonebook</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=backup">Backup &amp; Restore</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=customcontextsadmin">Custom Contexts Admin</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=dundicheck">DUNDi Lookup</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=javassh">Java SSH</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=phpinfo">PHP Info</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=phpagiconf">PHPAGI Config</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=printextensions">Print Extensions</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=outroutemsg">Route Congestion Messages</a></li>
			<li class="menuitem id-tool-afde5a73d112b230adb0e3b203265409"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=weakpasswords">Weak Password Detection</a></li>
		<li title="click to expand/collapse section" id="tool-b988b61dd9ca7cbbea7d68b6b24d749f" class="category category-header toggle-minus">Third Party Addon</li>
			<li class="menuitem id-tool-b988b61dd9ca7cbbea7d68b6b24d749f"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=customerdb">Customer DB</a></li>
			<li class="menuitem id-tool-b988b61dd9ca7cbbea7d68b6b24d749f"><a href="http://10.20.30.42/admin/config.php?type=tool&amp;display=inventorydb">Inventory</a></li>
	</ul></div>
</div>

<!-- end menu -->

<div id="wrapper"><div id="background-wrapper">

<div id="left-corner"></div>
<div id="right-corner"></div>


<div id="language">
	
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<select onchange="javascript:changeLang(this.value)">
		<option value="en_US" selected="selected">English</option>
		<option value="bg_BG">Bulgarian</option>
		<option value="zh_CN">Chinese</option>
		<option value="de_DE">Deutsch</option>
		<option value="es_ES">Español</option>
		<option value="fr_FR">Français</option>
		<option value="he_IL">Hebrew</option>
		<option value="hu_HU">Hungarian</option>
		<option value="it_IT">Italiano</option>
		<option value="pt_PT">Portuguese</option>
		<option value="pt_BR">Portuguese (Brasil)</option>
		<option value="ro_RO">Romanian</option>
		<option value="ru_RU">Russki</option>
		<option value="sv_SE">Svenska</option>
		</select>

<script type="text/javascript">
<!--
function changeLang(lang) {
	document.cookie='lang='+lang;
	window.location.reload();
}
//-->
</script>

	</div>
	
	
<div class="content">

<noscript>
	<div class="attention"></div>
</noscript>

<!-- begin generated page content  -->
</div>
<script type="text/javascript">
$(document).ready(function(){
  $("#routelist").sortable({ 
    items: 'li:gt(0)',
    cursor: 'move',
    update: function(event, ui){
      var repotrunkkey=+ui.item.attr('id').replace('routelist','');
      var repotrunkdirection=ui.item.index();repotrunkdirection--;
      var send_reload = '&send_reload='+($('#need_reload_block').size() == 0 ? 'yes':'no');
      $.ajax({
        type: 'POST',
        url: location.href,
        data: "action=ajaxroutepos&quietmode=1&skip_astman=1&restrictmods=core&repotrunkkey="+repotrunkkey+"&repotrunkdirection="+repotrunkdirection+send_reload,
        dataType: 'json',
        success: function(data) {
          /* if the reload_block is not there, we blindly insert the info we think we got because we told
             it in the ajax call to send it to use, should wo double check?
          */
          if ((data.show_reload == 'yes') && !$('#need_reload_block').fadeIn().size()) {
            $('#logo').after(data.reload_bar).fadeIn();
            $('#moduleBox').before(data.reload_header);
          }
          if (data.show_reload == 'yes') {
            $('#need_reload_block').fadeIn();
          }
        },
        error: function(data) {
          alert("");
        }
      });
	  }
  }).disableSelection();
});
</script>
<div class="rnav">
<ul class="ui-sortable" id="routelist">
	<li><a href="http://10.20.30.42/admin/config.php?display=routing">Add Route</a></li>
	<li id="routelist1">
		<a class="current" href="http://10.20.30.42/admin/config.php?display=routing&amp;extdisplay=1" title="Drag up or down to reposition, click to choose"><img src="admin_data/arrow_up_down.png" alt="move" style="float:none; margin-left:-6px; margin-bottom:-3px;cursor:move" height="16" border="0" width="16"> teisejaama</a>
	</li>
</ul>
</div>

<div class="content">

<h2>Edit Route</h2>	<p><a href="http://10.20.30.42/admin/config.php?display=routing&amp;extdisplay=1&amp;action=delroute"><span><img title="Delete Route teisejaama" alt="" src="admin_data/core_delete.png" height="16" border="0" width="16">&nbsp;Delete Route teisejaama</span></a></p>
	<form enctype="multipart/form-data" autocomplete="off" id="routeEdit" name="routeEdit" action="config.php" method="POST" onsubmit="return routeEdit_onsubmit('editroute');">
		<input name="display" value="routing" type="hidden">
		<input name="extdisplay" value="1" type="hidden">
		<input id="action" name="action" value="" type="hidden">

		<input id="repotrunkdirection" name="repotrunkdirection" value="" type="hidden">
		<input id="repotrunkkey" name="repotrunkkey" value="" type="hidden">
		<input id="reporoutedirection" name="reporoutedirection" value="" type="hidden">
		<input id="reporoutekey" name="reporoutekey" value="" type="hidden">
		<table>
    <tbody><tr>
      <td colspan="2"><h5>Route Settings<hr></h5></td>
    </tr>

		<tr>
			<td>
				<a href="javascript:void(null)" class="info">Route Name<span><br>Name of this route. Should be used to describe what type of calls this route matches (for example, 'local' or 'longdistance').<br></span></a>: 
			</td>
			<td>
				<input size="20" name="routename" value="teisejaama" tabindex="1" type="text">
			</td>
		</tr>

		<tr>
      <td><a href="javascript:void(null)" class="info">Route CID:<span>Optional Route CID to be used for this route. If set, this will override all CIDS specified except:<ul><li>extension/device EMERGENCY CIDs if this route is checked as an EMERGENCY Route</li><li>trunk CID if trunk is set to force it's CID</li><li>Forwarded call CIDs (CF, Follow Me, Ring Groups, etc)</li><li>Extension/User CIDs if checked</li></ul></span></a></td>
			<td>
        <input size="20" name="outcid" tabindex="2" type="text">
        <input tabindex="3" name="outcid_mode" id="outcid_mode" value="override_extension" type="checkbox"><a href="javascript:void(null)" class="info"><small>Override Extension</small><span style="left: -377px;">If
 checked the extension's Outbound CID will be ignored in favor of this 
CID. The extension's Emergency CID will still be used if the route is an
 Emergency Route and the Extension has a defined Emergency CID.</span></a>
      </td>
		</tr>

		<tr>
			<td><a href="javascript:void(null)" class="info">Route Password:<span>Optional:
 A route can prompt users for a password before allowing calls to 
progress.  This is useful for restricting calls to international 
destinations or 1-900 numbers.<br><br>A numerical password, or the path to an Authenticate password file can be used.<br><br>Leave this field blank to not prompt for password.</span></a></td>
			<td><input size="20" name="routepass" tabindex="4" type="text"></td>
		</tr>

		<tr>
      <td><a href="javascript:void(null)" class="info">Route Type:<span>Optional:
 Selecting Emergency will enforce the use of a device's Emergency CID 
setting (if set).  Select this option if this route is used for 
emergency dialing (ie: 911).<br>Optional: Selecting Intra-Company will 
treat this route as an intra-company connection, preserving the internal
 CallerID information instead of the outbound CID of either the 
extension or trunk.</span></a></td>
      <td>
        <input name="emergency" value="YES" tabindex="5" type="checkbox"><small>Emergency</small>
        <input name="intracompany" value="YES" checked="checked" tabindex="6" type="checkbox"><small>Intra-Company</small>
      </td>
		</tr>

    <tr>
      <td><a href="javascript:void(null)" class="info">Music On Hold?<span>You
 can choose which music category to use. For example, choose a type 
appropriate for a destination country which may have announcements in 
the appropriate language.</span></a></td>
      <td>
        <select name="mohsilence" tabindex="7">
        <option value="default" selected="selected">default</option>
<option value="moh">moh</option>
<option value="none">none</option>
		
        </select>		
      </td>
    </tr>

    <tr>
      <td><a href="javascript:void(null)" class="info">Time Group:<span>If
 this route should only be available during certain times then Select a 
Time Group created under Time Groups. The route will be ignored outside 
of times specified in that Time Group. If left as default of Permanent 
Route then it will always be available.</span></a></td>
      <td>
			<select name="time_group_id" tabindex="8" id="time_group_id">
<option selected="selected" value="">---Permanent Route---</option>			</select>
		</td>
    </tr>
		<tr>

		</tr><tr>
			<td><a href="javascript:void(null)" class="info">Route Position<span>Where to insert this route or relocate it relative to the other routes.</span></a></td>
			<td>
				<select name="route_seq" tabindex="9">
				<option value="0" selected="selected">---No Change---</option>
		
				</select>		
			</td>
		</tr>
    <tr>
      <td colspan="2"><h5>Additional Settings<hr></h5></td>
    </tr>

        <tr>
          <td><a href="javascript:void(null)" class="info">PIN Set<span>Optional: Select a PIN set to use. If using this option, leave the Route Password field blank.</span></a>:</td>
          <td>
            <select name="pinsets">
              <option selected="selected" value="">None</option>
      
						</select>
					</td>
				</tr>
			    <tr>
      <td colspan="2"><h5>
      <a href="javascript:void(null)" class="info">Dial Patterns that will use this Route<span>
      A Dial Pattern is a unique set of digits that will select this 
route and send the call to the designated trunks. If a dialed pattern 
matches this route, no subsequent routes will be tried. If Time Groups 
are enabled, subsequent routes will be checked for matches outside of 
the designated time(s).<br><br><b>Rules:</b><br>
      <b>X</b>&nbsp;&nbsp;&nbsp; matches any digit from 0-9<br>
      <b>Z</b>&nbsp;&nbsp;&nbsp; matches any digit from 1-9<br>
      <b>N</b>&nbsp;&nbsp;&nbsp; matches any digit from 2-9<br>
      <b>[1237-9]</b>&nbsp;   matches any digit in the brackets (example: 1,2,3,7,8,9)<br>
      <b>.</b>&nbsp;&nbsp;&nbsp; wildcard, matches one or more dialed digits <br>
      <b>prepend:</b>&nbsp;&nbsp;&nbsp; Digits to prepend to a 
successful match. If the dialed number matches the patterns specified by
 the subsequent columns, then this will be prepended before sending to 
the trunks.<br>
      <b>prefix:</b>&nbsp;&nbsp;&nbsp; Prefix to remove on a successful 
match. The dialed number is compared to this and the subsequent columns 
for a match. Upon a match, this prefix is removed from the dialed number
 before sending it to the trunks.<br>
      <b>match pattern:</b>&nbsp;&nbsp;&nbsp; The dialed number will be 
compared against the  prefix + this match pattern. Upon a match, the 
match pattern portion of the dialed number will be sent to the trunks<br>
      <b>CallerID:</b>&nbsp;&nbsp;&nbsp; If CallerID is supplied, the 
dialed number will only match the prefix + match pattern if the CallerID
 being transmitted matches this. When extensions make outbound calls, 
the CallerID will be their extension number and NOT their Outbound CID. 
The above special matching sequences can be used for CallerID matching 
similar to other number matches.<br>
      </span></a>
      <hr></h5></td>
    </tr>

    <tr><td colspan="2"><div class="dialpatterns"><table>
    <tbody><tr>
      <td colspan="2">
        (<input title="prepend" size="8" id="prepend_digit_0" name="prepend_digit[0]" class="dial-pattern dpt-title dpt-display toggleval" value="prepend" tabindex="10" type="text">) +        <input title="prefix" size="6" id="pattern_prefix_0" name="pattern_prefix[0]" class="dpt-title dpt-display toggleval" value="prefix" tabindex="11" type="text"> |        [<input title="match pattern" size="16" id="pattern_pass_0" name="pattern_pass[0]" class="dpt-value" value="3XXXX" tabindex="12" type="text"> /        <input title="CallerID" size="10" id="match_cid_0" name="match_cid[0]" class="dpt-title dpt-display toggleval" value="CallerID" tabindex="13" type="text">]        <img src="admin_data/trash.png" style="float:none; margin-left:0px; margin-bottom:-3px; cursor:pointer;" alt="remove" title="Click here to remove this pattern" onclick="patternsRemove(0)">
      </td>
    </tr>
    <tr>
      <td colspan="2">
        (<input title="prepend" size="8" id="prepend_digit_1" name="prepend_digit[1]" class="dial-pattern dpt-title dpt-display toggleval" value="prepend" tabindex="14" type="text">) +
        <input title="prefix" size="6" id="pattern_prefix_1" name="pattern_prefix[1]" class="dpt-title dpt-display toggleval" value="prefix" tabindex="15" type="text"> |
        [<input title="match pattern" size="16" id="pattern_pass_1" name="pattern_pass[1]" class="dpt-title dpt-display toggleval" value="match pattern" tabindex="16" type="text"> /
        <input title="CallerID" size="10" id="match_cid_1" name="match_cid[1]" class="dpt-title dpt-display toggleval" value="CallerID" tabindex="17" type="text">]
        <img src="admin_data/trash.png" style="float:none; margin-left:0px; margin-bottom:-3px;cursor:pointer;" alt="remove" title="Click here to remove this pattern" onclick="patternsRemove(1)">

      </td>
    </tr>
    <tr id="last_row"></tr> 
    </tbody></table></div></td></tr>
    <tr><td colspan="2">
      <input id="dial-pattern-add" value="+ Add More Dial Pattern Fields" type="button">
    </td></tr>
		<tr>
			<td>
			<a href="javascript:void(null)" class="info">Dial patterns wizards<span>
					These options provide a quick way to add outbound dialing rules. Follow the prompts for each.<br>
					<strong>Lookup local prefixes</strong> This looks up your local 
number on www.localcallingguide.com (NA-only), and sets up so you can 
dial either 7, 10 or 11 digits (5551234, 6135551234, 16135551234) to 
access this route.<br>
					<strong>Upload from CSV</strong> Upload patterns from a CSV file 
replacing existing entries. If there are no headers then the file must 
have 4 columns of patterns in the same order as in the GUI. You can also
 supply headers: <strong>prepend</strong>, <strong>prefix</strong>, <strong>match pattern</strong> and <strong>callerid</strong> in the first row. If there are less then 4 recognized headers then the remaining columns will be blank<br>
					</span></a>:
			<input id="npanxx" name="npanxx" type="hidden">
			<script language="javascript">
			
			function populateLookup() {
				
				//var npanxx = prompt("What is your areacode + prefix (NPA-NXX)?", document.getElementById('areacode').value);
				do {
					var npanxx = prompt("What is your areacode + prefix (NPA-NXX)?\n\n(Note: this database contains North American numbers only, and is not guaranteed to be 100% accurate. You will still have the option of modifying results.)\n\nThis may take a few seconds.");
					if (npanxx == null) return;
				} while (!npanxx.match("^[2-9][0-9][0-9][-]?[2-9][0-9][0-9]$") && !alert("Invalid NPA-NXX. Must be of the format \'NXX-NXX\'"));
				
				document.getElementById('npanxx').value = npanxx;
				document.getElementById('routeEdit').action.value = "populatenpanxx";
        clearPatterns();
				document.getElementById('routeEdit').submit();
			}

			function insertCode() {
        // hide the file box if nothing was set
        if ($('#pattern_file').val() == '') {
          $('#pattern_file').hide();
        }
				code = document.getElementById('inscode').value;
				insert = '';
				switch(code) {
					case "local":
            insert = 'NXXXXXX';
					break;
					case "local10":
            insert = 'NXXXXXX,NXXNXXXXXX';
					break;
					case 'tollfree':
            insert = '1800NXXXXXX,1888NXXXXXX,1877NXXXXXX,1866NXXXXXX,1855NXXXXXX';
					break;
					case "ld":
            insert = '1NXXNXXXXXX';
					break;
					case "int":
            insert = '011.';
					break;
					case 'info':
            insert = '411,311';
					break;
					case 'emerg':
            insert = '911';
					break;
					case 'lookup':
						populateLookup();
						insert = '';
					break;
					case 'csv':
            $('#pattern_file').show().click();
            return true;
					break;
				}

        patterns = insert.split(',')
        for (var i in patterns) {
          addCustomField("","",patterns[i],"");
        }

				// reset element
				document.getElementById('inscode').value = '';
			}
			
			--></script>
			</td><td>
				<select onchange="insertCode();" id="inscode">
			<option selected="selected" value="">(pick one)</option>
			<option value="local">Local 7 digit</option>
			<option value="local10">Local 7/10 digit</option>
			<option value="tollfree">Toll-free</option>
			<option value="ld">Long-distance</option>
			<option value="int">International</option>
			<option value="info">Information</option>
			<option value="emerg">Emergency</option>
			<option value="lookup">Lookup local prefixes</option>
			<option value="csv">Upload from CSV</option>
				</select>
        <input style="display: none;" name="pattern_file" id="pattern_file" tabindex="2018" type="file">
			</td>
		</tr>

    <tr>
      <td colspan="2"><h5><a href="javascript:void(null)" class="info">Trunk Sequence for Matched Routes<span>The Trunk Sequence controls the order of trunks that will be used when the above Dial Patterns are matched. <br><br>For
 Dial Patterns that match long distance numbers, for example, you'd want
 to pick the cheapest routes for long distance (ie, VoIP trunks first) 
followed by more expensive routes (POTS lines).<br></span></a><hr></h5></td>
    </tr>
		<tr>
			<td>0&nbsp;&nbsp;
		    <select id="trunkpri0" name="trunkpriority[0]" style="background: #FFF ;" onchange="showDisable(0); return true;">
				<option value="" style="background: #FFF;"></option>
				<option id="trunk0" name="trunk0" value="1" style="background: #FFF;" selected="selected">PBX1-PBX2</option>				</select>
				
				<img src="admin_data/trash.png" style="cursor:pointer; float:none; margin-left:0px; margin-bottom:-3px;" title="Click here to remove this trunk" onclick="deleteTrunk(0)">
							<img src="admin_data/blank.gif" style="float:none; margin-left:0px; margin-bottom:0px;" height="11" width="9">
							<img src="admin_data/blank.gif" style="float:none; margin-left:0px; margin-bottom:0px;" height="11" width="9">
						</td>
		</tr>
		<tr>
			<td>1&nbsp;&nbsp;
				<select id="trunkpri1" name="trunkpriority[1]">
				<option value="" selected="selected"></option>
				<option value="1">PBX1-PBX2</option>				</select>
			</td>
		</tr>

		<tr>
			<td colspan="2">
				<input value="Add Trunk" type="submit">
			</td>
		</tr>

		<tr>
			<td colspan="2">
        <h6>
          <input name="Submit" value="Submit Changes" type="submit">
          <input name="copyroute" value="Duplicate Route" type="submit">
				</h6>
			</td>
		</tr>
		</tbody></table>
 
<script language="javascript">
<!--

$(document).ready(function(){
  /* Add a Custom Var / Val textbox */
  $("#dial-pattern-add").click(function(){
    addCustomField('','','','');
  });
  $('#pattern_file').hide();
  $(".dpt-display").toggleVal({
    populateFrom: "title",
    changedClass: "text-normal",
    focusClass: "text-normal"
  });
  $(".dpt-nodisplay").mouseover(function(){
    $(this).toggleVal({
      populateFrom: "title",
      changedClass: "text-normal",
      focusClass: "text-normal"
    }).removeClass('dpt-nodisplay').addClass('dpt-display').unbind('mouseover');
  });
}); 

function patternsRemove(idx) {
  $("#prepend_digit_"+idx).parent().parent().remove();
}

function addCustomField(prepend_digit, pattern_prefix, pattern_pass, match_cid) {
  var idx = $(".dial-pattern").size();
  var idxp = idx - 1;
  var tabindex = parseInt($("#match_cid_"+idxp).attr('tabindex')) + 1;
  var tabindex1 = tabindex + 2;
  var tabindex2 = tabindex + 3;
  var tabindex3 = tabindex + 4;
  var dpt_title = 'dpt-title dpt-display';
  var dpt_prepend_digit = prepend_digit == '' ? dpt_title : 'dpt-value';
  var dpt_pattern_prefix = pattern_prefix == '' ? dpt_title : 'dpt-value';
  var dpt_pattern_pass = pattern_pass == '' ? dpt_title : 'dpt-value';
  var dpt_match_cid = match_cid == '' ? dpt_title : 'dpt-value';

  var new_insert = $("#last_row").before('\
  <tr>\
    <td colspan="2">\
    (<input title="prepend" type="text" size="8" id="prepend_digit_'+idx+'" name="prepend_digit['+idx+']" class="dial-pattern '+dpt_prepend_digit+'" value="'+prepend_digit+'" tabindex="'+tabindex+'">) +\
    <input title="prefix" type="text" size="6" id="pattern_prefix_'+idx+'" name="pattern_prefix['+idx+']" class="'+dpt_pattern_prefix+'" value="'+pattern_prefix+'" tabindex="'+tabindex1+'"> |\
    [<input title="match pattern" type="text" size="16" id="pattern_pass_'+idx+'" name="pattern_pass['+idx+']" class="'+dpt_pattern_pass+'" value="'+pattern_pass+'" tabindex="'+tabindex2+'"> /\
    <input title="CallerID" type="text" size="10" id="match_cid_'+idx+'" name="match_cid['+idx+']" class="'+dpt_match_cid+'" value="'+match_cid+'" tabindex="'+tabindex3+'">]\
      <img src="images/trash.png" style="cursor:pointer; float:none; margin-left:0px; margin-bottom:-3px;" alt="remove" title="Click here to remove this pattern" onclick="patternsRemove('+idx+')">\
    </td>\
  </tr>\
  ').prev();

  new_insert.find(".dpt-title").toggleVal({
    populateFrom: "title",
    changedClass: "text-normal",
    focusClass: "text-normal"
  });

  return idx;
}

var theForm = document.routeEdit;

if (theForm.routename.value == "") {
	theForm.routename.focus();
} else {
	theForm.outcid.focus();
}

function showDisable(key) {
bgc = { "1":"#FFF" };
	if (document.getElementById('trunkpri'+key).value =='') {
		document.getElementById('trunkpri'+key).style.background = '#FFF';
	} else {
		document.getElementById('trunkpri'+key).style.background = bgc[document.getElementById('trunkpri'+key).value];
	}
}

function routeEdit_onsubmit(act) {
	var msgInvalidRouteName = "Route name is invalid, please try again";
	var msgInvalidRoutePwd = "Route password must be numeric or leave blank to disable";
	var msgInvalidTrunkSelection = "At least one trunk must be picked";
	var msgInvalidOutboundCID = "Invalid Outbound CallerID";
	
	var rname = theForm.routename.value;
	if (!rname.match('^[a-zA-Z0-9][a-zA-Z0-9_\-]+$'))
		return warnInvalid(theForm.routename, msgInvalidRouteName);
	
	defaultEmptyOK = true;
	if (!isInteger(theForm.routepass.value))
		return warnInvalid(theForm.routepass, msgInvalidRoutePwd);
	if (!isCallerID(theForm.outcid.value))
		return warnInvalid(theForm.outcid, msgInvalidOutboundCID);
	
	defaultEmptyOK = false;
  /* TODO: get some sort of check in for dialpatterns
	if (!isDialpattern(theForm.dialpattern.value))
		return warnInvalid(theForm.dialpattern, msgInvalidDialPattern);
    */
		
	if (theForm.trunkpri0.value == "") { // should they all be checked ?
		theForm.trunkpri0.focus();
		alert(msgInvalidTrunkSelection);
		return false;
	}
	
	theForm.action.value = act;

  clearPatterns();
  return validatePatterns();
}

function clearPatterns() {
  $(".dpt-display").each(function() {
    if($(this).val() == $(this).data("defText")) {
      $(this).val("");
    }
  });
  return true;
}

function validatePatterns() {
  var one_good = false;
  var culprit;
  var msgInvalidDialPattern;
  defaultEmptyOK = false;

  $(".dpt-display, .dpt-value").each(function() {
    if ($.trim($(this).val()) == '') {
    } else if (!isDialpattern($(this).val())) {
      culprit = this;
      return false;
    } else {
      one_good = true;
    }
  });

  if (culprit == undefined && !one_good) {
    if ($('#inscode').val() == 'csv') {
      return true;
    }
    culprit = $('.toggleval:visible').get(0);
	  msgInvalidDialPattern = "No dial pattern, there must be at least one";
  } else {
	  msgInvalidDialPattern = "Dial pattern is invalid";
  }
  if (culprit != undefined) {
    // now we have to put it back...
    // do I have to turn it off first though?
    $(".dpt-display").each(function() {
      if ($.trim($(this).val()) == '') {
        $(this).toggleVal({
          populateFrom: "title",
          changedClass: "text-normal",
          focusClass: "text-normal"
        });
      }
    });
    return warnInvalid(culprit, msgInvalidDialPattern);
  } else {
    return true;
  }
}

//TODO: maybe add action vs. it being blank and assumed above?
function repositionTrunk(key,direction) {
  switch (direction) {
  case 'up':
  case 'down':
    document.getElementById('repotrunkdirection').value=direction;
    document.getElementById('repotrunkkey').value=key;
    clearPatterns();
    document.getElementById('routeEdit').submit();
    break;
  }
}

function deleteTrunk(key) {
	document.getElementById('trunkpri'+key).value = '';
  clearPatterns();
	document.getElementById('routeEdit').submit();
}

function repositionRoute(key,direction){
  switch (direction) {
  case 'up':
  case 'down':
  case 'top':
  case 'bottom':
    document.getElementById('reporoutedirection').value=direction;
    document.getElementById('reporoutekey').value=key;
    document.getElementById('action').value='prioritizeroute';
    clearPatterns();
    document.getElementById('routeEdit').submit();
    break;
  }
}

//-->
</script>

</form>
<!-- end generated page content -->

</div> <!-- .content -->

<hr><div id="footer"><span class="footer-float-left"><a target="_blank" href="http://www.freepbx.org/"><img id="footer_logo" src="admin_data/freepbx_small.png" alt="FreePBX®"></a></span><span class="footer-float-left"><h3>Let Freedom Ring<sup>™</sup></h3>		<a href="http://www.freepbx.org/" target="_blank">FreePBX</a> is a registered trademark of <a href="http://www.freepbx.org/copyright.html" target="_blank">Bandwidth.com</a><br>
		<a href="http://www.freepbx.org/" target="_blank">FreePBX 2.9.0.12</a> is licensed under <a href="http://www.gnu.org/copyleft/gpl.html" target="_blank">GPL</a><br></span></div></div> <!-- content -->
</div> <!-- page -->


</div></div></body></html>